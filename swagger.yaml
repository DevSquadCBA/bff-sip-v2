openapi: 3.0.1
info:
  title: Sistema integral piatti
  version: 1.0.0

# security:
#     - CustomSecurityAuthorizer: []

servers:
  - url: "https://dev-sip.devsquadcba.com/api"
    description: Develop
  - url: "https://sip.devsquadcba.com/api"
    description: Produccion
  - url: http://127.0.0.1/
    description: localhost

paths:
  /client:
    #C
    post:
      tags:
        - Clientes
      summary: Crea un nuevo Cliente
      description: Crea un nuevo cliente
      operationId: CreateClient
      requestBody:
        content:
          application/json:
            schema: 
              $ref: "#/components/schemas/Client"
      responses:
        200:
          description: listado de clientes
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
    #R
    get:
      tags:
        - Clientes
      summary: Obtiene todos los clientes
      description: Obtiene un listado de todos los clientes activos y no activos
      operationId: getClients
      parameters: []
      responses:
        200:
          description: listado de clientes
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
  /client/{idClient}:
    get:
      tags:
        - Clientes
      summary: Get client by ID
      description: Obtiene un solo cliente a través de su ID del sistema.
      operationId: GetClientById
      parameters:
        - name: idClient
          in: path
          description: el id del cliente
          schema: 
            type: number
          required: true
      responses:
        200:
          description: Un cliente
          content: 
            application/json:
              schema: 
                $ref: '#/components/schemas/Client'
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
    #U
    put:
      tags:
        - Clientes
      summary: Actualiza un Cliente
      description: Crea un nuevo cliente
      operationId: UpdateClient
      parameters:
        - name: idClient
          in: path
          description: el id del cliente
          schema: {}
          required: true
        - name: client
          in: query
          description: El cliente con todos los datos
          schema: {}
          required: true
      requestBody:
        content:
          application/json:
            schema: {}
      responses:
        200:
          description: listado de clientes
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
    #D
    delete:
      tags:
        - Clientes
      summary: Da de baja un Cliente
      description: Da de baja un cliente del sistema.
      operationId: DeleteClient
      parameters:
        - name: idClient
          in: path
          description: el id del cliente
          schema: 
            type: number
          required: true
      responses:
        200:
          description: listado de clientes
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
  /client/{idClient}/sales:
    get:
      tags:
        - Presupuestos
      summary: Obtiene todos los presupuestos de un cliente
      description: Obtiene los presupuestos de un cliente en concreto
      operationId: GetClientSale
      parameters:
        - name: idClient
          in: path
          description: el id del cliente
          schema: {}
          required: true
        # - name: idSale
        #   in: query
        #   description: el id del presupuesto en particular
        #   schema:
        #     type: integer
        #     format: int64
        #   required: false
        # - name: status
        #   in: query
        #   description: el estatus
        #   schema:
        #     type: string
        #   required: false
      responses:
        200:
          description: listado de ventas
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
  /clients:
    get:
      tags:
        - Clientes
      summary: Obtiene los clientes con datos. 
      description: Obtiene los clientes con los campos correspondientes para renderizar la tabla
      operationId: GetClientsList
      responses:
        200:
          description: Un array de clientes
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
  /sales:
    get:
      tags:
        - Presupuestos
      summary: Obtiene todos los presupuestos
      description: Obtiene un listado de todos los presupuestos
      operationId: GetSales
      parameters: []
      responses:
        200:
          description: estos son todos los presupuestos
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
  /sale:
    post:
      tags:
        - Presupuestos
      summary: Crea un nuevo Presupuesto
      description: Crea un nuevo Presupuesto
      operationId: Createsale
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Newsale"
      responses:
        200:
          description: Devuelve el id del presupuesto creado
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
  /sale/{idSale}:
    get:
      tags:
        - Presupuestos
      summary: Obtiene un presupuesto
      description: Obtiene un presupuesto basándose en el ID
      operationId: GetSaleById
      parameters:
        - name: idSale
          in: path
          description: El ID del presupuesto
          schema: {}
          required: true
      responses:
        200:
          description: Un Presupuesto
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Sale'
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}

  
  /sale/{idSale}/addProducts:
    post:
      tags:
        - agrega productos
      summary: agrega, quita, actualiza productos de un presupuesto
      description: agrega, quita, actualiza productos de un presupuesto
      operationId: AddOrRemoveProducts
      parameters:
        - name: idSale
          in: path
          description: el id del presupuesto
          schema: {}
          required: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/addProducts"
      responses:
        200:
          description: crea productos
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}

  /product:
    post:
      tags:
        - Productos
      summary: Crea un nuevo Producto
      description: Crea un nuevo Producto
      operationId: CreateProduct
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Product"
      responses:
        200:
          description: Devuelve el id del Producto creado
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
    get:
      tags:
        - Productos
      summary: Te devuelve todos los productos
      description: Te devuelve todos los productos
      operationId: GetProducts
      parameters: []
      responses:
        200:
          description: listado de productos
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}

  /product/{idProduct}:
    get:
      tags:
        - Productos
      summary: Obtiene un producto
      description: Obtiene un producto en particular basado en su id
      operationId: GetProductById
      parameters:
        - name: idProduct
          in: path
          description: el id del producto
          schema:
            type: number
          required: true
      responses:
        200:
          description: Un producto
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}

    delete:
      tags:
        - Productos
      summary: Da de baja un producto
      description: Da de baja lógica un producto que estaba en estado pendiente
      operationId: DeleteProduct
      parameters:
        - name: idProduct
          in: path
          description: el id del producto
          schema: {}
          required: true
      responses:
        200:
          description: listado de clientes
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}

    put:
      tags:
        - Productos
      summary: Crea un nuevo Producto
      description: Crea un nuevo Producto
      operationId: UpdateProduct
      parameters:
        - name: idProduct
          in: path
          description: el id del Producto
          schema: {}
          required: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Product"
      responses:
        200:
          description: Devuelve el id del presupuesto creado
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}

  /products:
    get:
      tags:
        - Productos
      summary: Obtiene los productos con datos.
      description: Obtiene los productos con sus respectivos proveedores.
      operationId: GetProductWithProvider
      responses:
        200:
          description: Productos con proveedores
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}

  /provider:
    post:
      tags:
        - Proveedores
      summary: Crea un nuevo Proveedor
      description: Crea un nuevo Proveedor
      operationId: CreateProvider
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Provider"
      responses:
        200:
          description: Devuelve el id del proveedor creado
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}

    get:
      tags:
        - Proveedores
      summary: Te devuelve todos los Proveedores
      description: Te devuelve todos los Proveedores
      operationId: GetProviders
      responses:
        200:
          description: listado de clientes
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}

  /provider/{idProvider}:
    delete:
      tags:
        - Proveedores
      summary: Da de baja un Proveedor
      description: Da de baja lógica un Proveedor
      operationId: DeleteProvider
      parameters:
        - name: idProvider
          in: path
          description: el id del Proveedores
          schema: {}
          required: true
      responses:
        200:
          description: un proveedor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Provider'
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
    get:
      tags:
        - Proveedores
      summary: Te devuelve el Proveedor
      description: Te devuelve el Proveedores con el id proporcionado
      operationId: GetProviderById
      parameters:
        - name: idProvider
          in: path
          description: el id del proveedor
          schema: {}
          required: true
      responses:
        200:
          description: listado de clientes
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
    put:
      tags:
        - Proveedores
      summary: Actualiza un Proveedor
      description: Actualiza un Proveedor
      operationId: UpdateProvider
      parameters:
        - name: idProvider
          in: path
          description: el id del presupuesto
          schema: {}
          required: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Provider"
      responses:
        200:
          description: Devuelve el id del presupuesto creado
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
    post:
      tags:
        - Proveedores
      summary: Actualiza precios basado en un porcentaje
      description: El porcentaje de actualización de los precios de un proveedor
      operationId: UpdateProductPrices
      parameters:
        - name: idProvider
          in: path
          description: el id del proveedor
          schema: {}
          required: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/percentPrice"
      responses:
        200:
          description: listado de productos actualizados
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}

  /search/client:
    get:
      tags:
        - Search
      summary: Busca clientes
      description: Te devuelve clientes que coincidan con la consulta
      operationId: SearchClient
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Search"
              required: true
      responses:
        200:
          description: listado de clientes
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
  /search/sale:
    get:
      tags:
        - Search
      summary: Busca el Presupuesto
      description: Te devuelve el presupuesto que coincidan con la consulta
      operationId: SearchSale
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Search"
              required: true
      responses:
        200:
          description: listado de presupuestos
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
  /search/product:
    get:
      tags:
        - Search
      summary: Busca productos
      description: Te devuelve productos que coincidan con la consulta
      operationId: SearchProduct
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Search"
              required: true
      responses:
        200:
          description: listado de productos
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
  /search/provider:
    get:
      tags:
        - Search
      summary: Busca Provedores
      description: Te devuelve provedores que coincidan con la consulta
      operationId: SearchProvider
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Search"
              required: true
      responses:
        200:
          description: listado de provedores
          content: {}
          headers:
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
        500:
          description: Error
          content:
            application/json:
              schema: {}
  /count:
    get:
      tags: 
        - Utils
      summary: Cuenta los diferentes registros
      description: Cuenta los diferentes registros
      operationId: Count
      responses:
        200:
          description: 'ok'
          content:
            application/json:
              schema:
                type: object
                properties:
                  sales:
                    type: integer
                  clients:
                    type: integer
                  products:
                    type: integer
                  providers:
                    type: integer
        500:
          description: Error
          content:
            application/json:
              schema: {}
              
  /admin/syncDB:
    get:
      tags: 
        - Admin
      summary: Sincroniza la base de datos
      description: Sincroniza la base de datos
      operationId: SyncDB
      responses:
        200:
          description: 'ok'            
          content:
            application/json:
              schema:
                type: string
        401:
          description: NotAuthorized
          content:
            application/json:
              schema:
                type: string
  /admin/fakeData:
    get:
      tags: 
        - Admin
      summary: Sincroniza la base de datos
      description: Sincroniza la base de datos
      operationId: FakeData
      responses:
        200:
          description: 'ok'            
          content:
            application/json:
              schema:
                type: string
        401:
          description: NotAuthorized
          content:
            application/json:
              schema:
                type: string
  
components:
  schemas:
    Search:
      type: object
      required: 
        - q
      properties:
        q:
          type: string
    Client:
      type: object
      required:
        - name
        - lastName
        - whatsapp
      properties:
        name:
          type: string
        lastName:
          type: string
        email:
          type: string
        phone:
          type: integer
        whatsapp:
          type: integer
        direction:
          type: string
    Sale:
      type: object
      properties:
        id:
          type: integer
        date:
          type: string
          example: "2023/01/01 00:00:00"
        clientId:
          type: integer
        status:
          type: string
          enum: [iniciated,waiting_shipping,to_confirm,out_of_stock,in_tansit,finished]
        deleted:
          type: boolean
    Product:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        salePrice:
          type: integer
        purchasePrice:
          type: integer
        provider:
          type: integer
        img:
          type: string
        daysDelay:
          type: integer
    Provider:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        daysDelay:
          type: integer
    NewSale:
      type: object
      properties:
        creationDate:
          type: string
          example: "2023/01/01 00:00:00"
        clientId:
          type: integer
          minimum: 1
        state:
          type: string
          enum: [iniciated,waiting_shipping,to_confirm,out_of_stock,in_tansit,finished]
          example: initiated
        total:
          type: integer
          example: 10000
          minimum: 1
        products:
          type: object
          $ref: "#/components/schemas/addProducts"
    addProducts:
      type: array
      items:
        type: object
        properties:
          id:
            type: integer
            example: 1
          quantity:
            type: integer
            example: 2
    percentPrice:
      type: object
      required: 
          - percent
      properties: 
        percent: 
          type: number
          example: 10
          
